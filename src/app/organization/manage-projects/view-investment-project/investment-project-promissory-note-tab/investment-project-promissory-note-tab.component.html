<!-- "Proyect name":"Nombre del proyecto",
"Finantial value": "Valor a financiar",
"Finantial value date": "Valor a financiar",
"Reservation date":"Valor en reserva a la fecha",
"Mimum investment":"Inversión mínima",
"Maximum investment":"Inversión máxima",
"Start investments date":"Fecha de inicio de la inversiónes",
"End investments date":"Fecha de termino de la inversiónes", -->
<div class="flex justify-center items-center py-8 loader" *ngIf="loading">
  <mat-spinner diameter="40"></mat-spinner>
</div>
<section class="tab-container mat-typography mt-10" *ngIf="!isCreatingPromissoryNoteGroup && !loading">
  <div fxLayout="row" fxLayoutAlign="end">
    <button mat-raised-button class="outlinedButton" (click)="createGroup()">
      <fa-icon icon="plus" size="sm"></fa-icon>
      Crear grupo
    </button>
  </div>
  <table mat-table #documentsTable [dataSource]="dataSourceGroups" matSort class="m-t-25">
    <ng-container matColumnDef="Number">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>N° de pagaré</th>
      <td mat-cell *matCellDef="let note">{{ note.documentNumber }}</td>
    </ng-container>

    <ng-container matColumnDef="Mnemotécnico">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>{{ 'labels.inputs.custom.Mnemonic' | translate }}</th>
      <td mat-cell *matCellDef="let note">{{ note.mnemonic }}</td>
    </ng-container>

    <ng-container matColumnDef="InvestmentNumber">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>'N° de inversiones'</th>
      <td mat-cell *matCellDef="let note">{{ note.investmentList.length }}</td>
    </ng-container>
    <ng-container matColumnDef="Amount">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Monto total</th>
      <td mat-cell *matCellDef="let note">${{ getMontoTotal(note.investmentList) | currency: currency }}</td>
    </ng-container>
    <ng-container matColumnDef="State">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>{{ 'labels.inputs.Status' | translate }}</th>
      <td mat-cell *matCellDef="let note">{{ getStateLabel(note.status?.value) }}</td>
    </ng-container>
    <ng-container matColumnDef="Process">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Proceso</th>

      <td mat-cell *matCellDef="let note">
        <section class="statusProcessContainer">
          <div
            [ngClass]="{
              circle: true,
              'in-progress': note.process?.status === 'RUNNING',
              approved: note.process?.status === 'SUCCESS',
              rejected: note.process?.status === 'ERROR',
              none: !note.process?.status
            }"
          ></div>
          {{ getInvestmentProcessGroupStatusLabel(note.process?.status) }}
          <button
            *ngIf="!!getToolTipInfo(note.process)"
            class="xs-button"
            mat-icon-button
            [matTooltip]="getToolTipInfo(note.process)"
          >
            ⓘ
          </button>
        </section>
      </td>
    </ng-container>
    <ng-container matColumnDef="Actions">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        {{ 'labels.inputs.Actions' | translate }}
      </th>
      <td mat-cell *matCellDef="let note; let index">
        <button
          *ngIf="note.status?.id === 300"
          class="document-action-button"
          mat-raised-button
          color="primary"
          (click)="startEditingPromissoryNoteGroup(note.id)"
        >
          <fa-icon icon="eye"></fa-icon>
        </button>
        <button
          *ngIf="note.status?.value != 'SIGNED'"
          class="document-action-button"
          mat-raised-button
          color="primary"
          (click)="startEditingPromissoryNoteGroup(note.id)"
        >
          <fa-icon icon="edit"></fa-icon>
        </button>
        <button
          *ngIf="note.status?.value != 'SIGNED' && note.investmentList.length === 0"
          class="document-action-button"
          mat-raised-button
          color="primary"
          (click)="deletePromissoryNoteGroup(note.id)"
        >
          <fa-icon icon="trash"></fa-icon>
        </button>
      </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="displayedColumnsGroups"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumnsGroups"></tr>
    <tr class="mat-row noContentTable" *matNoDataRow>
      <td class="mat-cell" [attr.colspan]="displayedColumnsGroups.length">
        <div class="empty-state">
          <fa-icon [icon]="filesvg" size="3x"></fa-icon>
          <p>No hay pagares relacionados a este proyecto</p>
          <a [routerLink]="'../../../project-participation/' + 'projectData.id'">
            <button mat-raised-button color="primary">TODO</button>
          </a>
        </div>
      </td>
    </tr>
  </table>
</section>
