<main class="container">
  <form [formGroup]="filters" fxLayout="row wrap" fxLayoutGap="25px" fxLayoutAlign="space-between center">
    <!-- Tipo de cliente -->
    <mat-form-field fxFlex="20%" class="inputSearch m-b-10">
      <mat-label>Tipo de cliente</mat-label>
      <mat-select formControlName="clientType">
        <mat-option *ngFor="let type of []" [value]="type.value">
          {{ type.label }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <!-- RUT -->
    <mat-form-field fxFlex="20%" class="inputSearch m-b-10">
      <mat-label>RUT</mat-label>
      <input matInput formControlName="rut" />
    </mat-form-field>

    <!-- Id transacción -->
    <mat-form-field fxFlex="20%" class="inputSearch m-b-10">
      <mat-label>Id transacción</mat-label>
      <input matInput formControlName="transactionId" />
    </mat-form-field>

    <!-- Estado -->
    <mat-form-field fxFlex="20%" class="inputSearch m-b-10">
      <mat-label>Estado</mat-label>
      <mat-select formControlName="status">
        <mat-option *ngFor="let status of []" [value]="status.value">
          {{ status.label }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <!-- Botones -->
    <div fxFlex="100%" fxLayout="row" fxLayoutAlign="end center" class="m-b-10" fxLayoutGap="10px" class="m-r-20">
      <button mat-raised-button color="primary" class="m-r-10" type="button" (click)="onSearch()">Buscar</button>

      <button mat-stroked-button color="primary" type="button" (click)="onClear()">Limpiar</button>
    </div>
  </form>
  <table mat-table [dataSource]="dataSource" matSort class="m-t-25 conciliation-table">
    <!-- Fecha Sistema -->
    <ng-container matColumnDef="systemDate">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Fecha Sistema</th>
      <td mat-cell *matCellDef="let row">
        {{ row.systemDate | date: 'dd-MM-yyyy' }}
      </td>
    </ng-container>

    <!-- RUT -->
    <ng-container matColumnDef="rut">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>RUT</th>
      <td mat-cell *matCellDef="let row">
        {{ row.rut }}
      </td>
    </ng-container>

    <!-- Tipo de cliente -->
    <ng-container matColumnDef="clientType">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Tipo de cliente</th>
      <td mat-cell *matCellDef="let row">
        {{ row.clientType }}
      </td>
    </ng-container>

    <!-- Cliente -->
    <ng-container matColumnDef="clientName">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Cliente</th>
      <td mat-cell *matCellDef="let row">
        {{ row.clientName }}
      </td>
    </ng-container>

    <!-- ID transacción -->
    <ng-container matColumnDef="transactionId">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>ID transacción</th>
      <td mat-cell *matCellDef="let row">
        {{ row.transactionId }}
      </td>
    </ng-container>

    <!-- Monto total -->
    <ng-container matColumnDef="totalAmount">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Monto total</th>
      <td mat-cell *matCellDef="let row">
        {{ row.totalAmount | currency: currency }}
      </td>
    </ng-container>

    <!-- Nº de asignaciones -->
    <ng-container matColumnDef="assignmentsCount">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Nº de asignaciones</th>
      <td mat-cell *matCellDef="let row">
        {{ row.assignmentsCount }}
      </td>
    </ng-container>

    <!-- Estado -->
    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Estado</th>
      <td mat-cell *matCellDef="let row">
        <span class="status-pill" [ngClass]="getStatusClass(row.status)"></span>
        {{ getStatusLabel(row.status) }}
      </td>
    </ng-container>

    <!-- Acciones -->
    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef>Acciones</th>
      <td mat-cell *matCellDef="let row">
        <button
          mat-raised-button
          color="primary"
          class="action-btn"
          matTooltip="Ver detalle"
          (click)="$event.stopPropagation(); onView(row)"
        >
          <fa-icon icon="eye"></fa-icon>
        </button>

        <button
          mat-raised-button
          color="primary"
          class="action-btn"
          matTooltip="Asignar"
          *ngIf="canAssign(row)"
          (click)="$event.stopPropagation(); onAssign(row)"
        >
          <fa-icon icon="exchange-alt"></fa-icon>
          <!-- usa el icono que quieras -->
        </button>
      </td>
    </ng-container>

    <!-- Header y filas -->
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns" (click)="onRowClick(row)" style="cursor: pointer"></tr>

    <!-- Sin datos -->
    <tr class="mat-row noContentTable" *matNoDataRow>
      <td class="mat-cell" [attr.colspan]="displayedColumns.length">
        <div class="empty-state">
          <fa-icon [icon]="filesvg" size="3x"></fa-icon>
          <p>No hay transacciones para mostrar.</p>
        </div>
      </td>
    </tr>
  </table>

  <!-- Paginador -->
  <mat-paginator [pageSize]="10" [pageSizeOptions]="[5, 10, 25]" showFirstLastButtons> </mat-paginator>
</main>
